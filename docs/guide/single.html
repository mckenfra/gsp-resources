<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
    <head>
        <title>GSP Resources 0.4.4</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8" />
        <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8" />
    <script type="text/javascript">
function addJsClass(el) {
    var classes = document.body.className.split(" ");
    classes.push("js");
    document.body.className = classes.join(" ");
}
    </script>
    </head>

    <body class="body" onload="addJsClass();">
        <div id="navigation">
            <ul>
                <li>
                    <div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)">
                        <a href="../guide/index.html" class="button">Table of contents</a>
                        <div id="nav-summary-childs" style="display:none;">
                            
                            <div class="toc-item" style="margin-left:0"><a href="#1.%20Overview"><strong>1</strong><span>Overview</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0"><a href="#2.%20Installation"><strong>2</strong><span>Installation</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0"><a href="#3.%20Usage"><strong>3</strong><span>Usage</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0"><a href="#4.%20Limitations"><strong>4</strong><span>Limitations</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0"><a href="#5.%20Advanced%20Configuration"><strong>5</strong><span>Advanced Configuration</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0"><a href="#6.%20Version%20History"><strong>6</strong><span>Version History</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0"><a href="#7.%20Special%20Thanks"><strong>7</strong><span>Special Thanks</span></a></div>
                            
                        </div>
                    </div>
                </li>
                <li class="separator selected">
                    <a id="ref-button" onclick="localToggle(); return false;" href="#">Quick Reference</a>
                </li>
            </ul>
        </div>
        <div id="header">
            <div class="images clearfix">
                
                
            </div>
            <p>Use resources plugin to serve dynamically-built CSS and JS as static files instead of dynamic (non-cacheable) GSPs.</p>
        </div>


        <table id="colset" border="0" cellpadding="0" cellspacing="0">
            <tr>
                <td id="col1">
                    <div id="main" class="corner-all">

                        <span id='toggle-col1' class="toggle">(<a href="#" onclick="localToggle(); return false;">Quick Reference</a>)</span>

                        <div class="project">
                            <h1>GSP Resources - Reference Documentation</h1>
                            <p><strong>Authors:</strong> </p>
                            <p><strong>Version:</strong> 0.4.4</p>
                            
                        </div>

                        
                        <div id="table-of-content">
                            <h2>Table of Contents</h2>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#1.%20Overview"><strong>1</strong><span>Overview</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#2.%20Installation"><strong>2</strong><span>Installation</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#3.%20Usage"><strong>3</strong><span>Usage</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#4.%20Limitations"><strong>4</strong><span>Limitations</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#5.%20Advanced%20Configuration"><strong>5</strong><span>Advanced Configuration</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#5.1%20Delayed%20Processing"><strong>5.1</strong><span>Delayed Processing</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#5.2%20Simple%20HTML%20Cache"><strong>5.2</strong><span>Simple HTML Cache</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#6.%20Version%20History"><strong>6</strong><span>Version History</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#7.%20Special%20Thanks"><strong>7</strong><span>Special Thanks</span></a></div>
                            
                            <div style="clear:both" ></div>
                        </div>
                        
                        

<h1 id="1. Overview">1 Overview</h1>
This plugin allows you to reference GSP-generated files as cacheable static resources.
Consider the following:<p class="paragraph"/><h3>fibonacci.js.gsp</h3>
<div class="code"><pre>&#60;% fib = &#123;n &#45;&#62;; <span class="java&#45;keyword">return</span> n &#60;= 1 ? n : fib(n&#45;1) + fib(n&#45;2)&#125; %&#62;
<span class="java&#45;keyword">var</span> fibonacci = &#91;&#60;%= (0..10).collect&#123; fib.call(it) &#125;.join(',') %&#62;&#93;;</pre></div><p class="paragraph"/>This is then cacheable and serveable as a javascript file as:<p class="paragraph"/><h3>fibonacci.js</h3>
<div class="code"><pre><span class="java&#45;keyword">var</span> fibonacci = &#91;0,1,1,2,3,5,8,13,21,34,55&#93;;</pre></div>



<h1 id="2. Installation">2 Installation</h1>
The preferred method for installing plugins is to add a plugin dependency
in <code>grails-app/conf/BuildConfig.groovy</code>, i.e.:<p class="paragraph"/><div class="code"><pre>plugins &#123;
    // Other plugin dependencies here
    // . . .
    // . . .<p class="paragraph"/>    runtime ':gsp&#45;resources:latest.integration'
&#125;</pre></div><p class="paragraph"/>Alternatively, you can install manually with the following command:<p class="paragraph"/><div class="code"><pre>grails install&#45;plugin gsp&#45;resources</pre></div>



<h1 id="3. Usage">3 Usage</h1>
In your project resources file, define GSPs as resources like any other resource type:<p class="paragraph"/><div class="code"><pre>'style' &#123;
    resource url:'css/test.css.gsp'
&#125;</pre></div><p class="paragraph"/>The GSP will be compiled to a file with exactly the same URI, but minus the '.gsp'
extension. The type of the compiled file (i.e. in this case 'css') will be automatically
detected from the filename. Should you wish to name your file with a file extension
that is not recognised by the resources plugin, you can optionally explicitly define the
file type of the compiled resource using the following example 	configuration:<p class="paragraph"/><div class="code"><pre>'style' &#123;
    resource url:'somefile.gsp', attrs:&#91;rel: 'stylesheet/css', type:'css'&#93;
&#125;</pre></div><p class="paragraph"/>Note the additional <code>attrs</code> parameter, which is used to tell
the resources plugin the type of the resource being generated. (In this example,
the compiled file will simply be named 'somefile' with no extension.) 


<h1 id="4. Limitations">4 Limitations</h1>
Since this plugin is meant to serve <strong class="bold">static</strong> resources, there is no
inherent data-watching within GSPs. Changes to a GSP file itself will
trigger recompilation, but changes to the data referenced within a GSP will not.



<h1 id="5. Advanced Configuration">5 Advanced Configuration</h1>



<h2 id="5.1 Delayed Processing">5.1 Delayed Processing</h2>
One limitation of the <code>resources</code> plugin in connection with GSP compilation
is that the processing of static resources takes place during server startup.<p class="paragraph"/>In fact, the processing could take place before a lot of the core grails
infrastructure has been loaded. If your GSP resources contain <code>&#60;g:include /&#62;</code>
tags, for example, it is possible the grails support for loading other groovy
pages will not yet have been loaded when the <code>resources</code> plugin starts processing
your GSP. This will result in errors!<p class="paragraph"/>To get around this, the <code>gsp-resources</code> plugin provides an additional configuration
option, for delaying the start of resources processing during server startup. The
following configuration option should be placed in <code>grails-app/conf/Config.groovy</code>:<p class="paragraph"/><div class="code"><pre>grails.resources.processing.startup = <span class="java&#45;quote">"delayed"</span></pre></div><p class="paragraph"/>This will delay resources processing until the bootstrap phase - by which point
all required plugins and artefacts should be fully loaded.<p class="paragraph"/>For even finer control, you can disable resources processing during server startup
entirely, with the following configuration:<p class="paragraph"/><div class="code"><pre>grails.resources.processing.startup = <span class="java&#45;keyword">false</span></pre></div><p class="paragraph"/>You can then manually trigger the initial resources processing by adding the
following code to your project's <code>Bootstrap.groovy</code>:<p class="paragraph"/><div class="code"><pre>class BootStrap &#123;<p class="paragraph"/>    // Automatically injected
    def grailsResourceProcessor<p class="paragraph"/>    def init = &#123; servletContext &#45;&#62;<p class="paragraph"/>        // Do whatever preparation you need first
        // E.g. create some objects that your GSPs will need
        // . . .
        // . . .<p class="paragraph"/>        // Finally, start resources processing
        grailsResourceProcessor.start()
    &#125;<p class="paragraph"/>    def destroy = &#123;
    &#125;<p class="paragraph"/>&#125;</pre></div><p class="paragraph"/><blockquote class="note">
If no <code>grails.resources.processing.startup</code> configuration option is found in
<code>Config.groovy</code>, or an invalid value is used, then the resources
plugin defaults to its normal startup.
</blockquote>



<h2 id="5.2 Simple HTML Cache">5.2 Simple HTML Cache</h2>
One potential use of the <code>gsp-resources</code> plugin is to cache the HTML output
of some controller action as a static <code>.html</code> file. Note that the <code>.html</code> file
will be created on server startup, and will not change after that.<p class="paragraph"/><h4>Example</h4><p class="paragraph"/>We are going to cache the output of <code>http://localhost:8080/myapp/about/me</code><p class="paragraph"/><h4>1. Create a new directory under <code>web-app</code></h4><p class="paragraph"/>We will use <code>web-app/cache</code> in this example, but any directory name is fine.<p class="paragraph"/><h4>2. Configure resources plugin to include new directory</h4><p class="paragraph"/>Make the following change to <code>grails-app/conf/Config.groovy</code><p class="paragraph"/><div class="code"><pre>// Note we have added '/cache/&#42;' to the existing list
grails.resources.adhoc.patterns = &#91;'/images/&#42;', '/css/&#42;', '/js/&#42;', '/plugins/&#42;', '/cache/&#42;'&#93;</pre></div><p class="paragraph"/><h4>3. Configure resources plugin to delay processing</h4><p class="paragraph"/>Make the following change to <code>grails-app/conf/Config.groovy</code><p class="paragraph"/><div class="code"><pre>grails.resources.processing.startup = <span class="java&#45;quote">"delayed"</span></pre></div><p class="paragraph"/><h4>4. Create GSP to cache controller output</h4><p class="paragraph"/>Add the below content to <code>web-app/cache/aboutme.html.gsp</code><p class="paragraph"/><div class="code"><pre>&#60;g:include controller=<span class="java&#45;quote">"about"</span> action=<span class="java&#45;quote">"me"</span>/&#62;</pre></div><p class="paragraph"/><h4>5. Add new GSP to <code>resources</code> plugin configuration</h4><p class="paragraph"/>Make the following change to <code>grails-app/conf/ApplicationResources.groovy</code><p class="paragraph"/><div class="code"><pre>modules = &#123;
    aboutme &#123;
        resource url:'/cache/aboutme.html.gsp'
    &#125;
&#125;</pre></div><p class="paragraph"/><h4>6. Check results</h4><p class="paragraph"/>You should now be able to view the cached file at
<code>http://localhost:8080/myapp/cache/aboutme.html</code><p class="paragraph"/><blockquote class="note">
You will need to restart your server first, so that the <code>resources</code> plugin incorporates
the config change setting made in Step #2. Unfortunately, the current version of
<code>resources</code> (v1.2) cannot hotload changes to this setting.<p class="paragraph"/>Note, this server restart is only required once - i.e. when first adding the new
<code>/cache/*</code> adhoc pattern to the resources config. From then on, the <code>resources</code> plugin
will automatically intercept URLs of the form <code>myapp/cache</code> and map them to the actual
URL of the requested resource.
</blockquote> 



<h1 id="6. Version History">6 Version History</h1>
<table class="wiki-table" cellpadding="0" cellspacing="0" border="0"><tr><th><strong class="bold">Version</strong></th><th><strong class="bold">Date</strong></th><th><strong class="bold">Description</strong></th></tr><tr class="table-odd"><td>0.4.4</td><td>Sep 29, 2013</td><td>- Bugfix: incompatible with resources 1.2.1<br/>- Bugfix: <code>.css.gsp</code> resources broken on Windows due to JVM bug</td></tr><tr class="table-even"><td>0.4.3</td><td>Sep 18, 2013</td><td>Bugfix: ensure plugin loads after <code>resources</code> plugin</td></tr><tr class="table-odd"><td>0.4.2</td><td>Sep 13, 2013</td><td><strong class="bold">Enhancements/Fixes</strong>:<br/>- Allow rendered GSPs in bundles<br/>- Fix broken dependencies due to grails 2.3<br/>- Fix compatibility with Servlet 2.5 and 3.0</td></tr><tr class="table-even"><td>0.4.1</td><td>Jul 6, 2012</td><td>Bugfix: preserve <code>type</code> from <code>Resources.groovy</code> configuration</td></tr><tr class="table-odd"><td>0.4</td><td>Jun 25, 2012</td><td><strong class="bold">Enhancements/Fixes</strong>:<br/>- Support all types of GSP output (e.g. HTML) without special configuration<br/>- Support <code>grails.resources.debug</code> config setting<br/>- Generated files now saved in <code>~/.grails</code>, like other resources plugins</td></tr><tr class="table-even"><td>0.31</td><td>Mar 23, 2012</td><td>Made compatible with Servlet 2.5 (already 3.0)</td></tr><tr class="table-odd"><td>0.3</td><td>Mar 21, 2012</td><td><strong class="bold">Enhancements/Fixes</strong>:<br/>- Fix bug causing <code>createLink</code> to break after using gsp-resources<br/>- Fix bug causing <code>resource(dir:"/")</code> to render incorrect context path<br/>- Automatically detect compiled file type from filename<br/>- Support <code>&#60;r:require/&#62;</code>, <code>&#60;g:include/&#62;</code> etc. in GSPs<br/>- Support GSP resource files located in plugins <br/>- Allow delaying resources processing until bootstrap phase<br/>- Process resources in order of <code>dependsOn</code> config</td></tr><tr class="table-even"><td>0.2.1</td><td>Oct 25, 2011</td><td>Set included resources version to 1.1.1, dependsOn to '1.0.2 &#62; *'</td></tr><tr class="table-odd"><td>0.2</td><td>Oct 22, 2011</td><td>Fixed g:createLink<br/>Made plugin compatible with 2.0RC1.</td></tr><tr class="table-even"><td>0.1</td><td>Oct 15, 2011</td><td>Initial implementation</td></tr></table>



<h1 id="7. Special Thanks">7 Special Thanks</h1>
Stefan Kendall for creating the original <a href="https://github.com/stefankendall/gsp-resources" target="blank">gsp-resources plugin</a>,
which was superb and inspired me to get involved to help make it even better!<p class="paragraph"/>Marc Palmer for the excellent <a href="http://grails-plugins.github.com/grails-resources/guide/single.html" target="blank">resources plugin</a>,
without which this plugin would not be possible. 


                    </div>
                </td>
                <td id="col2">
            <div class="local clearfix">
                <div class="local-title">
                    <a href="../guide/index.html" target="mainFrame">Quick Reference</a>
                    <span class="toggle">(<a href="#" onclick="localToggle(); return false;">hide</a>)</span>
                </div>
                <div class="menu">
                    
                </div>
            </div>
        </td>
            </tr>
        </table>

        <div id="footer">
            
            
        </div>



<script type="text/javascript" src="../js/docs.js"></script>

    </body>
</html>
